<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="BootCoupon.ReceiptPrintPreview"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:BootCoupon"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

	<Page.Resources>
		<local:DecimalFormatConverter x:Key="DecimalFormatter" Format="N2"/>
		<local:ThaiNumberToTextConverter x:Key="ThaiNumberConverter"/>
		<!-- เพิ่มสีที่ต้องการใช้ -->
		<SolidColorBrush x:Key="HeaderBackgroundBrush" Color="#C2D5F2"/>
		<SolidColorBrush x:Key="TotalAmountBrush" Color="Black"/>
		<SolidColorBrush x:Key="BorderBrush" Color="#505050"/>
		<SolidColorBrush x:Key="LightBlueBrush" Color="#E6F2FF"/>
	</Page.Resources>

	<!-- Main Grid สำหรับจัดวาง -->
	<Grid >

		<!-- Receipt Paper Area - จัดกึ่งกลางหน้าจอ -->
		<ScrollViewer HorizontalAlignment="Center" VerticalAlignment="Center"
                      ZoomMode="Enabled" HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Auto" Margin="20,80,20,20">

			<!-- A5 Size: 148 x 210 mm = 559 x 794 pixels at 96 DPI -->
			<Grid Background="White" Width="559" Height="794"
                  BorderBrush="#CCCCCC" BorderThickness="1">
				<StackPanel Padding="25">

					<!-- Header Section with Logo -->
					<Grid Margin="0,0,0,15">
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto" />
							<RowDefinition Height="Auto" />
						</Grid.RowDefinitions>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="Auto" />
						</Grid.ColumnDefinitions>

						<!-- Logo centered at the top -->
						<Image Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                               Source="/Assets/AsiaHotelLogo.jpg"
                               Height="80"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,10"/>

						<!-- Company Info below the logo -->
						<StackPanel Grid.Row="1" Grid.Column="0" VerticalAlignment="Top">
							<TextBlock Text="บริษัท เอเชียโฮเต็ล จำกัด ( มหาชน ) สำนักงานใหญ่"
                                       Foreground="Black" FontSize="12"
                                       TextWrapping="Wrap"/>
							<TextBlock Text="296 ถนนพญาไท แขวงถนนเพชรบุรี"
                                       Foreground="Black" FontSize="12"
                                       TextWrapping="Wrap"/>
							<TextBlock Text="เขตราชเทวี กรุงเทพมหานคร 10400"
                                       Foreground="Black" FontSize="12"
                                       TextWrapping="Wrap"/>
							<TextBlock Text="เลขประจำตัวผู้เสียภาษี 0107535000346"
                                       Foreground="Black" FontSize="12"/>
							<TextBlock Text="โทร 02-2170808"
                                       Foreground="Black" FontSize="12"/>
						</StackPanel>

						<!-- Receipt Title -->
						<StackPanel Grid.Row="2" Grid.Column="1" Grid.RowSpan="2" VerticalAlignment="Top">
							<Border Background="#C2D5F2" CornerRadius="8" Padding="10" Margin="10,0,0,0"
                                    BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" VerticalAlignment="Top">
								<TextBlock Text="ใบเสร็จรับเงิน/ใบกำกับภาษีอย่างย่อ&#x0a;ต้นฉบับ"
                                           TextWrapping="Wrap" TextAlignment="Center" VerticalAlignment="Center"
                                           FontWeight="SemiBold" Foreground="Black" FontSize="16" />
							</Border>
						</StackPanel>
					</Grid>

					<!-- Customer and Receipt Info Table -->
					<Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="2" Margin="0,0,0,15">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto" />
								<RowDefinition Height="Auto" />
								<RowDefinition Height="Auto" />
							</Grid.RowDefinitions>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="80" />
								<ColumnDefinition Width="*" />
								<ColumnDefinition Width="90" />
								<ColumnDefinition Width="150" />
							</Grid.ColumnDefinitions>

							<!-- Row 1: ชื่อลูกค้า and เลขที่ -->
							<Border Grid.Row="0" Grid.Column="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,1" Background="{StaticResource LightBlueBrush}">
								<TextBlock Text="ชื่อลูกค้า :" Margin="6" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</Border>
							<Border Grid.Row="0" Grid.Column="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,1">
								<TextBlock x:Name="CustomerNameTextBlock" Text="" Margin="6" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</Border>
							<Border Grid.Row="0" Grid.Column="2" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,1" Background="{StaticResource LightBlueBrush}">
								<TextBlock Text="เลขที่ / No." Margin="6" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</Border>
							<Border Grid.Row="0" Grid.Column="4" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
								<TextBlock x:Name="ReceiptNumberTextBlock" Text="" FontSize="12" VerticalAlignment="Center" Margin="0,0,4,0" HorizontalAlignment="Right" Foreground="Black" />
							</Border>

							<!-- Row 2: ที่อยู่ and วันที่ -->
							<Border Grid.Row="1" Grid.Column="2" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,1" Background="{StaticResource LightBlueBrush}">
								<TextBlock Text="วันที่ / Date" Margin="6" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</Border>
							<Border Grid.Row="1" Grid.Column="4" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
								<TextBlock x:Name="ReceiptDateTextBlock" Text="" FontSize="12" VerticalAlignment="Center" Margin="0,0,4,0" HorizontalAlignment="Right" Foreground="Black" />
							</Border>

							<!-- Row 3: โทรศัพท์ -->
							<Border Grid.Row="1" Grid.Column="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0" Background="{StaticResource LightBlueBrush}">
								<TextBlock Text="โทรศัพท์ :" Margin="6" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</Border>
							<Border Grid.Row="1" Grid.Column="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">
								<TextBlock x:Name="CustomerPhoneTextBlock" Text="" Margin="6" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</Border>
							<Border Grid.Row="1" Grid.Column="2" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">
							</Border>
							<Border Grid.Row="1" Grid.Column="3" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,0">
							</Border>
						</Grid>
					</Border>

					<!-- Items Table -->
					<Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="2,0,2,2">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto" />
								<RowDefinition Height="Auto" />
								<RowDefinition Height="*" />
								<RowDefinition Height="Auto" />
							</Grid.RowDefinitions>

							<!-- Table Header -->
							<Grid Grid.Row="0">
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="50" />
									<ColumnDefinition Width="*" />
									<ColumnDefinition Width="70" />
									<ColumnDefinition Width="90" />
									<ColumnDefinition Width="90" />
								</Grid.ColumnDefinitions>
								<Grid.RowDefinitions>
									<RowDefinition Height="Auto" />
									<RowDefinition Height="Auto" />
								</Grid.RowDefinitions>

								<!-- Headers -->
								<Border Grid.Column="0" Grid.Row="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,1,0" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="ลำดับที่" TextAlignment="Center" FontWeight="SemiBold" FontSize="11" Margin="3" Foreground="Black" />
								</Border>
								<Border Grid.Column="0" Grid.Row="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,1,1" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="Item" TextAlignment="Center" FontSize="10" Margin="3" Foreground="Black" />
								</Border>

								<Border Grid.Column="1" Grid.Row="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,1,0" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="รายการ" TextAlignment="Center" FontWeight="SemiBold" FontSize="11" Margin="3" Foreground="Black" />
								</Border>
								<Border Grid.Column="1" Grid.Row="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,1,1" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="Descriptions" TextAlignment="Center" FontSize="10" Margin="3" Foreground="Black" />
								</Border>

								<Border Grid.Column="2" Grid.Row="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,1,0" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="จำนวน" TextAlignment="Center" FontWeight="SemiBold" FontSize="11" Margin="3" Foreground="Black" />
								</Border>
								<Border Grid.Column="2" Grid.Row="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,1,1" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="Quantity" TextAlignment="Center" FontSize="10" Margin="3" Foreground="Black" />
								</Border>

								<Border Grid.Column="3" Grid.Row="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,1,0" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="ราคาต่อหน่วย" TextAlignment="Center" FontWeight="SemiBold" FontSize="11" Margin="3" Foreground="Black" />
								</Border>
								<Border Grid.Column="3" Grid.Row="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,1,1" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="Unit price" TextAlignment="Center" FontSize="10" Margin="3" Foreground="Black" />
								</Border>

								<Border Grid.Column="4" Grid.Row="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="จำนวนเงิน" TextAlignment="Center" FontWeight="SemiBold" FontSize="11" Margin="3" Foreground="Black" />
								</Border>
								<Border Grid.Column="4" Grid.Row="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,1" Background="{StaticResource HeaderBackgroundBrush}">
									<TextBlock Text="Amount" TextAlignment="Center" FontSize="10" Margin="3" Foreground="Black" />
								</Border>
							</Grid>

							<!-- Items List -->
							<ListView Grid.Row="2" x:Name="ItemsListView"
                                      IsItemClickEnabled="False"
                                      SelectionMode="None"
                                      IsHitTestVisible="False"
                                      Background="Transparent"
                                      BorderThickness="0"
                                      Padding="0"
                                      Margin="0">
								<ListView.ItemContainerStyle>
									<Style TargetType="ListViewItem">
										<Setter Property="Padding" Value="0"/>
										<Setter Property="Margin" Value="0"/>
										<Setter Property="HorizontalContentAlignment" Value="Stretch"/>
									</Style>
								</ListView.ItemContainerStyle>
								<ListView.ItemTemplate>
									<DataTemplate>
										<Grid Background="White" Height="40">
											<Grid.ColumnDefinitions>
												<ColumnDefinition Width="50" />
												<ColumnDefinition Width="*" />
												<ColumnDefinition Width="70" />
												<ColumnDefinition Width="90" />
												<ColumnDefinition Width="90" />
											</Grid.ColumnDefinitions>

											<Border Grid.Column="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,1">
												<TextBlock Text="{Binding Index}" TextAlignment="Center" Foreground="Black" FontSize="12" VerticalAlignment="Center" />
											</Border>

											<Border Grid.Column="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,1">
												<TextBlock Text="{Binding Name}" Foreground="Black" FontSize="12" VerticalAlignment="Center" Margin="5,0,0,0" />
											</Border>

											<Border Grid.Column="2" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,1">
												<TextBlock Text="{Binding Quantity}" TextAlignment="Center" Foreground="Black" FontSize="12" VerticalAlignment="Center" />
											</Border>

											<Border Grid.Column="3" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,1">
												<TextBlock Text="{Binding UnitPriceFormatted}" TextAlignment="Right" Foreground="Black" FontSize="12" VerticalAlignment="Center" Margin="0,0,5,0" />
											</Border>

											<Border Grid.Column="4" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
												<TextBlock Text="{Binding TotalPriceFormatted}" TextAlignment="Right" Foreground="Black" FontSize="12" VerticalAlignment="Center" Margin="0,0,5,0" />
											</Border>
										</Grid>
									</DataTemplate>
								</ListView.ItemTemplate>
							</ListView>

							<!-- Total Section -->
							<Grid Grid.Row="3">
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="*" />
									<!-- ข้อความไทย -->
									<ColumnDefinition Width="220" />
									<!-- ราคาสุทธิ(รวมภาษีมูลค่าเพิ่ม) -->
									<ColumnDefinition Width="90" />
									<!-- จำนวนเงิน -->
								</Grid.ColumnDefinitions>

								<!-- ซ้าย: ข้อความไทย -->
								<Border Grid.Column="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,0" Padding="6">
									<TextBlock Text="{Binding Text, ElementName=TotalAmountTextBlock, Converter={StaticResource ThaiNumberConverter}}"
                                                FontSize="12" VerticalAlignment="Center" Foreground="Black" TextWrapping="Wrap" />
								</Border>

								<!-- กลาง: ราคาสุทธิ(รวมภาษีมูลค่าเพิ่ม) -->
								<Border Grid.Column="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0" Padding="6">
									<TextBlock Text="ราคาสุทธิ(รวมภาษีมูลค่าเพิ่ม)"
                                                FontSize="12" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="Black" TextAlignment="Center" />
								</Border>

								<!-- ขวา: จำนวนเงิน -->
								<Border Grid.Column="2" BorderBrush="Red" BorderThickness="2" Background="White">
									<TextBlock x:Name="TotalAmountTextBlock" Text="4,398.00"
                                          TextAlignment="Right" FontWeight="Bold"
                                          Foreground="Black"
                                          FontSize="14" VerticalAlignment="Center" Margin="6" />
								</Border>
							</Grid>
						</Grid>
					</Border>

					<!-- Payment Methods -->
					<StackPanel Margin="0,15,0,0">
						<TextBlock Text="ชำระโดย" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,6" Foreground="Black" />
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto"/>
								<ColumnDefinition Width="Auto"/>
								<ColumnDefinition Width="Auto"/>
								<ColumnDefinition Width="Auto"/>
							</Grid.ColumnDefinitions>
							<StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,15,0">
								<Border BorderBrush="Black" BorderThickness="1" Width="16" Height="16" Margin="0,0,6,0" />
								<TextBlock Text="เงินสด" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</StackPanel>

							<StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,15,0">
								<Border BorderBrush="Black" BorderThickness="1" Width="16" Height="16" Margin="0,0,6,0" />
								<TextBlock Text="เงินโอน" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</StackPanel>

							<StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,15,0">
								<Border BorderBrush="Black" BorderThickness="1" Width="16" Height="16" Margin="0,0,6,0" />
								<TextBlock Text="เครดิตการ์ด" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</StackPanel>

							<StackPanel Grid.Column="3" Orientation="Horizontal">
								<Border BorderBrush="Black" BorderThickness="1" Width="16" Height="16" Margin="0,0,6,0" />
								<TextBlock Text="QR" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
							</StackPanel>
						</Grid>
					</StackPanel>

					<!-- Room Information -->
					<Grid Margin="0,15,0,0">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="150" />
						</Grid.ColumnDefinitions>

						<StackPanel Grid.Column="0">
							<StackPanel Orientation="Horizontal" Margin="0,0,0,6">
								<TextBlock Text="หมายเลขคูปองห้องอาหาร" FontSize="12" Width="130" Foreground="Black" />
								<Border BorderBrush="Black" BorderThickness="0,0,0,1" Width="170" Height="16" />
							</StackPanel>
							<StackPanel Orientation="Horizontal" Margin="0,0,0,10">
								<TextBlock Text="หมายเลขคูปองห้องพัก" FontSize="12" Width="130" Foreground="Black" />
								<Border BorderBrush="Black" BorderThickness="0,0,0,1" Width="170" Height="16" />
							</StackPanel>

							<!-- Rewards Section  -->
							<!--<StackPanel Orientation="Vertical">
                                <StackPanel Orientation="Horizontal" Margin="0,0,10,5">
                                    <Border BorderBrush="Black" BorderThickness="1" Width="16" Height="16" Margin="0,0,6,0"/>
                                    <TextBlock Text="cocktail 1 แก้ว" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,10,5">
                                    <Border BorderBrush="Black" BorderThickness="1" Width="16" Height="16" Margin="0,0,6,0" />
                                    <TextBlock Text="Wine 1 ขวด" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,10,5">
                                    <Border BorderBrush="Black" BorderThickness="1" Width="16" Height="16" Margin="0,0,6,0" />
                                    <TextBlock Text="พิซซ่า 1 ถาด" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,10,5">
                                    <Border BorderBrush="Black" BorderThickness="1" Width="16" Height="16" Margin="0,0,6,0" />
                                    <TextBlock Text="เฝอ 1 ที่" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,10,5">
                                    <Border BorderBrush="Black" BorderThickness="1" Width="16" Height="16" Margin="0,0,6,0"/>
                                    <TextBlock Text="เป็ด 1 ตัว" FontSize="12" VerticalAlignment="Center" Foreground="Black" />
                                </StackPanel>
                            </StackPanel> -->
						</StackPanel>

					</Grid>
					<!-- Sales & Signature -->
					<Grid Margin="0,15,0,0">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="150" />
						</Grid.ColumnDefinitions>

						<!-- Sales + display name and phone -->
						<StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
							<TextBlock Text="Sales: " FontWeight="SemiBold" FontSize="14" Foreground="Black"/>
							<TextBlock Text="{Binding SalesPersonName}" FontWeight="Normal" FontSize="14" Foreground="Black" Margin="5,0,0,0"/>
							<TextBlock Text="{Binding SalesPersonPhone}" FontSize="14" Foreground="Black" Margin="10,0,0,0"/>
						</StackPanel>

						<!-- ผู้รับเงิน -->
						<StackPanel Grid.Column="1" VerticalAlignment="Center">
							<Border BorderBrush="Black" BorderThickness="0,0,0,1" Width="120" Height="16" HorizontalAlignment="Right" />
							<TextBlock Text="ผู้รับเงิน" HorizontalAlignment="Center" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,0" Foreground="Black" />
						</StackPanel>
					</Grid>

				</StackPanel>
			</Grid>
		</ScrollViewer>

		<!-- Control Buttons Panel - อยู่ด้านขวาบน -->
		<StackPanel Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Margin="20"
                    Background="Transparent"
                    Canvas.ZIndex="1">

			<!-- ปุ่มพิมพ์ -->
			<Button Click="PrintButton_Click"
                    MinWidth="100" MinHeight="35" Margin="0,0,10,0"
                    Foreground="White" Background="#0078D7" BorderBrush="{StaticResource BorderBrush}"
                    FontSize="14" IsEnabled="True" IsHitTestVisible="True">
				<StackPanel Orientation="Horizontal">
					<FontIcon Glyph="&#xE749;" FontFamily="Segoe MDL2 Assets" Margin="0,0,5,0"/>
					<TextBlock Text="พิมพ์"/>
				</StackPanel>
			</Button>

			<!-- ปุ่มปิด -->
			<Button Content="ปิด" Click="CloseButton_Click"
                    MinWidth="100" MinHeight="35" Margin="10,0,10,0"
                    Foreground="Black" Background="#E0E0E0" BorderBrush="{StaticResource BorderBrush}"
                    FontSize="14" IsEnabled="True" IsHitTestVisible="True" />
		</StackPanel>
	</Grid>
</Page>