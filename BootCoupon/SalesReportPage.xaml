<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Name="RootPage"
    x:Class="BootCoupon.SalesReportPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="using:BootCoupon"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:conv="using:BootCoupon.Converters"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <conv:ReportModeToVisibilityConverter x:Key="ReportModeToVisibility" />
     <local:NullableDateToStringConverter x:Key="NullableDateToString" />
        <conv:ReportModeFilterVisibilityConverter x:Key="FilterVisibility" />
    </Page.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
  <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" Text="รายงานการขาย" 
          FontSize="28" FontWeight="Bold" 
  HorizontalAlignment="Center" 
 Margin="0,0,0,30"/>

        <!-- Filters Panel -->
        <Border Grid.Row="1" Background="{ThemeResource LayerFillColorDefaultBrush}" 
     BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" 
  BorderThickness="1" CornerRadius="8" Padding="20" Margin="0,0,0,20">
         <Grid>
           <Grid.RowDefinitions>
     <RowDefinition Height="Auto"/>
   <RowDefinition Height="Auto"/>
     <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
 <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
       <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*"/>
    <ColumnDefinition Width="*"/>
      <ColumnDefinition Width="*"/>
  </Grid.ColumnDefinitions>

           <!-- Title -->
          <TextBlock Grid.Row="0" Grid.ColumnSpan="3" Text="ตัวกรองข้อมูล" 
    FontSize="18" FontWeight="SemiBold" 
            Margin="0,0,0,15" HorizontalAlignment="Center" TextAlignment="Center"/>

      <!-- Row1: Date Range -->
     <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,15,15"
          Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource FilterVisibility}, ConverterParameter=StartDate}">
        <TextBlock Text="วันที่เริ่มต้น:" Margin="0,0,0,5" HorizontalAlignment="Center" TextAlignment="Center"/>
         <DatePicker x:Name="StartDatePicker" 
    SelectedDate="{x:Bind ViewModel.StartDate, Mode=TwoWay}"
     HorizontalAlignment="Stretch"/>
        </StackPanel>

         <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,15,15"
        Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource FilterVisibility}, ConverterParameter=EndDate}">
              <TextBlock Text="วันที่สิ้นสุด:" Margin="0,0,0,5" HorizontalAlignment="Center" TextAlignment="Center"/>
        <DatePicker x:Name="EndDatePicker" 
        SelectedDate="{x:Bind ViewModel.EndDate, Mode=TwoWay}"
        HorizontalAlignment="Stretch"/>
    </StackPanel>

 <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,0,0,15"
 Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource FilterVisibility}, ConverterParameter=SalesPerson}">
   <TextBlock Text="เซล:" Margin="0,0,0,5" HorizontalAlignment="Center" TextAlignment="Center"/>
      <ComboBox x:Name="SalesPersonComboBox" 
        ItemsSource="{x:Bind ViewModel.SalesPersons, Mode=OneWay}"
     SelectedItem="{x:Bind ViewModel.SelectedSalesPerson, Mode=TwoWay}"
         DisplayMemberPath="Name"
       PlaceholderText="ทุกคน"
         HorizontalAlignment="Stretch"/>
  </StackPanel>

    <!-- Row2: Coupon Filters -->
            <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,15,15"
      Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource FilterVisibility}, ConverterParameter=CouponType}">
     <TextBlock Text="ประเภทคูปอง:" Margin="0,0,0,5" HorizontalAlignment="Center" TextAlignment="Center"/>
          <ComboBox x:Name="CouponTypeComboBox" 
     ItemsSource="{x:Bind ViewModel.CouponTypes, Mode=OneWay}"
  SelectedItem="{x:Bind ViewModel.SelectedCouponType, Mode=TwoWay}"
      DisplayMemberPath="Name"
       PlaceholderText="ทุกประเภท"
 HorizontalAlignment="Stretch"
               SelectionChanged="CouponTypeComboBox_SelectionChanged"/>
          </StackPanel>

   <StackPanel Grid.Row="2" Grid.Column="1" Margin="0,0,15,15"
       Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource FilterVisibility}, ConverterParameter=Coupon}">
  <TextBlock Text="ชื่อคูปอง:" Margin="0,0,0,5" HorizontalAlignment="Center" TextAlignment="Center"/>
   <ComboBox x:Name="CouponComboBox" 
      ItemsSource="{x:Bind ViewModel.FilteredCoupons, Mode=OneWay}"
    SelectedItem="{x:Bind ViewModel.SelectedCoupon, Mode=TwoWay}"
    DisplayMemberPath="Name"
 PlaceholderText="ทุกคูปอง"
       HorizontalAlignment="Stretch"/>
  </StackPanel>

  <StackPanel Grid.Row="2" Grid.Column="2" Margin="0,0,0,15"
   Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource FilterVisibility}, ConverterParameter=PaymentMethod}">
        <TextBlock Text="วิธีการชำระเงิน:" Margin="0,0,0,5" HorizontalAlignment="Center" TextAlignment="Center"/>
        <ComboBox x:Name="PaymentMethodComboBox" 
     ItemsSource="{x:Bind ViewModel.PaymentMethods, Mode=OneWay}"
     SelectedItem="{x:Bind ViewModel.SelectedPaymentMethod, Mode=TwoWay}"
 DisplayMemberPath="Name"
PlaceholderText="ทุกประเภท"
       HorizontalAlignment="Stretch"/>
     </StackPanel>

 <!-- Row3: New Checkboxes for Cancelled Receipts -->
     <!-- ลบ Row3 ออกเพราะไม่ต้องการเช็คบ็อกซ์แล้ว -->

<!-- Report mode buttons -->
<StackPanel Grid.Row="4" Grid.ColumnSpan="3" Orientation="Horizontal" Spacing="10" Margin="0,0,0,15">
  <TextBlock Text="รูปแบบรายงาน:" VerticalAlignment="Center" Margin="0,0,10,0" HorizontalAlignment="Center" TextAlignment="Center"/>
    <StackPanel Orientation="Horizontal" Spacing="8">
  <Button x:Name="ByReceiptButton" Content="จัดตามใบเสร็จ" Tag="ByReceipt" Click="ReportModeButton_Click"/>
        <Button x:Name="LimitedCouponsButton" Content="คูปองจำกัดจำนวนพร้อมชื่อลูกค้า" Tag="LimitedCoupons" Click="ReportModeButton_Click"/>
        <Button x:Name="UnlimitedGroupedButton" Content="คูปองไม่จำกัด (รวมตามลูกค้า)" Tag="UnlimitedGrouped" Click="ReportModeButton_Click"/>
        <Button x:Name="SummaryByCouponButton" Content="สรุปตามยอดขายของคูปอง" Tag="SummaryByCoupon" Click="ReportModeButton_Click"/>
        <Button x:Name="RemainingCouponsButton" Content="จำนวนคูปองที่คงเหลือ" Tag="RemainingCoupons" Click="ReportModeButton_Click"/>
      <Button x:Name="CancelledReceiptsButton" Content="ใบเสร็จที่ถูกยกเลิก" Tag="CancelledReceipts" Click="ReportModeButton_Click" Foreground="{ThemeResource SystemFillColorCriticalBrush}"/>
    </StackPanel>
</StackPanel>

         <!-- Row5: Action Buttons -->
<StackPanel Grid.Row="5" Grid.ColumnSpan="3" Orientation="Horizontal" 
          HorizontalAlignment="Center" Spacing="15">
 <Button x:Name="SearchButton" Content="ค้นหา" 
           Click="SearchButton_Click" 
      Style="{StaticResource AccentButtonStyle}"
               MinWidth="120"/>
      <Button x:Name="ClearButton" Content="ล้างตัวกรอง" 
   Click="ClearButton_Click" 
       MinWidth="120"/>
       <Button x:Name="ExportExcelButton" Content="ส่งออก Excel (CSV)" 
          Click="ExportExcelButton_Click"
           MinWidth="140"/>
         <Button x:Name="ExportPdfButton" Content="ส่งออก PDF (Print to PDF)" 
  Click="ExportPdfButton_Click"
  MinWidth="160"/>
          <Button x:Name="PrintButton" Content="พิมพ์" 
       Click="PrintButton_Click"
        MinWidth="120"/>
     </StackPanel>
    </Grid>
        </Border>

        <!-- Results Area with ScrollViewer only for data -->
        <Border Grid.Row="2" Background="{ThemeResource LayerFillColorDefaultBrush}" 
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" 
                BorderThickness="1" CornerRadius="8" Padding="20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Summary -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="30" Margin="0,0,0,15">
                    <TextBlock Text="{x:Bind ViewModel.TotalRecordsText, Mode=OneWay}" 
                               FontWeight="SemiBold" HorizontalAlignment="Center" TextAlignment="Center"/>
                    <TextBlock Text="{x:Bind ViewModel.TotalAmountText, Mode=OneWay}" 
                               FontWeight="SemiBold" Foreground="{ThemeResource SystemAccentColor}" HorizontalAlignment="Center" TextAlignment="Center"/>
                </StackPanel>

                <!-- Data List with ScrollViewer -->
                <ScrollViewer Grid.Row="1" Grid.RowSpan="2" VerticalScrollBarVisibility="Auto" 
                              VerticalScrollMode="Auto" HorizontalScrollBarVisibility="Auto" 
                              HorizontalScrollMode="Auto" ZoomMode="Disabled">
                    <!-- ใช้ DataGrid แทน ListView เพื่อให้ Column ขยายได้ -->
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- ByReceipt table -->
                        <Border Grid.Row="0" Background="{ThemeResource SubtleFillColorSecondaryBrush}" BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=ByReceipt}">
                            <Grid MinWidth="1200">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="วันที่" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="เลขที่ใบเสร็จ" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="ลูกค้า" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="3" Text="เบอร์โทร" FontWeight="SemiBold" TextAlignment="Center" Padding="5"/>
                                <TextBlock Grid.Column="4" Text="เซล" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="5" Text="การชำระเงิน" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="6" Text="จำนวน" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="7" Text="รวม" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>

                                <!-- vertical separators -->
                                <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="6" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                            </Grid>
                        </Border>

                        <ItemsControl Grid.Row="1" ItemsSource="{x:Bind ViewModel.ReportData, Mode=OneWay}" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=ByReceipt}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="local:SalesReportItem">
                                    <Border BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8">
                                        <Grid MinWidth="1200">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="{x:Bind ReceiptDateDisplay}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="1" Text="{x:Bind ReceiptCode}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="2" Text="{x:Bind CustomerName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" TextTrimming="CharacterEllipsis" MaxLines="2" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="3" Text="{x:Bind CustomerPhone}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="4" Text="{x:Bind SalesPersonName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="5" Text="{x:Bind PaymentMethodName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="6" Text="{x:Bind Quantity}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="7" Text="{x:Bind TotalPriceDisplay}" VerticalAlignment="Center" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>

                                            <!-- vertical separators -->
                                            <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="6" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <!-- LimitedCoupons table -->
                        <Border Grid.Row="0" Background="{ThemeResource SubtleFillColorSecondaryBrush}" BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=LimitedCoupons}">
                            <Grid MinWidth="1200">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" MinWidth="100"/>
                                    <ColumnDefinition Width="*" MinWidth="120"/>
                                    <ColumnDefinition Width="*" MinWidth="120"/>
                                    <ColumnDefinition Width="*" MinWidth="180"/>
                                    <ColumnDefinition Width="*" MinWidth="180"/>
                                    <ColumnDefinition Width="*" MinWidth="120"/>
                                    <ColumnDefinition Width="*" MinWidth="120"/>
                                    <ColumnDefinition Width="*" MinWidth="100"/>
                                    <ColumnDefinition Width="*" MinWidth="100"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="วันที่" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="เลขที่ใบเสร็จ" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="รหัสคูปอง" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="3" Text="คูปอง" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="4" Text="ลูกค้า" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="5" Text="เบอร์โทร" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="6" Text="เซล" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="7" Text="วันหมดอายุ" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="8" Text="ราคา" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>

                                <!-- vertical separators -->
                                <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="6" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                            </Grid>
                        </Border>

                        <ItemsControl Grid.Row="1" ItemsSource="{x:Bind ViewModel.ReportData, Mode=OneWay}" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=LimitedCoupons}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="local:SalesReportItem">
                                    <Border BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8">
                                        <Grid MinWidth="1200">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" MinWidth="100"/>
                                                <ColumnDefinition Width="*" MinWidth="120"/>
                                                <ColumnDefinition Width="*" MinWidth="120"/>
                                                <ColumnDefinition Width="*" MinWidth="180"/>
                                                <ColumnDefinition Width="*" MinWidth="180"/>
                                                <ColumnDefinition Width="*" MinWidth="120"/>
                                                <ColumnDefinition Width="*" MinWidth="120"/>
                                                <ColumnDefinition Width="*" MinWidth="100"/>
                                                <ColumnDefinition Width="*" MinWidth="100"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="{x:Bind ReceiptDateDisplay}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="1" Text="{x:Bind ReceiptCode}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="2" Text="{x:Bind GeneratedCode}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="3" Text="{x:Bind CouponName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="4" Text="{x:Bind CustomerName}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="5" Text="{x:Bind CustomerPhone}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="6" Text="{x:Bind SalesPersonName}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="7" Text="{Binding ExpiresAt, Converter={StaticResource NullableDateToString}}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="8" Text="{x:Bind TotalPriceDisplay}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>

                                            <!-- vertical separators -->
                                            <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="6" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <!-- UnlimitedGrouped table (replaced to match LimitedCoupons columns, removed GeneratedCode and added ExpiresAt) -->
                        <Border Grid.Row="0" Background="{ThemeResource SubtleFillColorSecondaryBrush}" BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=UnlimitedGrouped}">
                            <Grid MinWidth="1200">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" MinWidth="100"/>
                                    <ColumnDefinition Width="*" MinWidth="120"/>
                                    <ColumnDefinition Width="*" MinWidth="180"/>
                                    <ColumnDefinition Width="*" MinWidth="180"/>
                                    <ColumnDefinition Width="*" MinWidth="120"/>
                                    <ColumnDefinition Width="*" MinWidth="120"/>
                                    <ColumnDefinition Width="*" MinWidth="100"/>
                                    <ColumnDefinition Width="*" MinWidth="100"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="วันที่" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="เลขที่ใบเสร็จ" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="คูปอง" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="3" Text="ลูกค้า" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="4" Text="เบอร์โทร" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="5" Text="เซล" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="6" Text="วันหมดอายุ" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="7" Text="รวม" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>

                                <!-- vertical separators -->
                                <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="6" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                            </Grid>
                        </Border>

                        <ItemsControl Grid.Row="1" ItemsSource="{x:Bind ViewModel.ReportData, Mode=OneWay}" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=UnlimitedGrouped}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="local:SalesReportItem">
                                    <Border BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8">
                                        <Grid MinWidth="1200">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" MinWidth="100"/>
                                                <ColumnDefinition Width="*" MinWidth="120"/>
                                                <ColumnDefinition Width="*" MinWidth="180"/>
                                                <ColumnDefinition Width="*" MinWidth="180"/>
                                                <ColumnDefinition Width="*" MinWidth="120"/>
                                                <ColumnDefinition Width="*" MinWidth="120"/>
                                                <ColumnDefinition Width="*" MinWidth="100"/>
                                                <ColumnDefinition Width="*" MinWidth="100"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" Text="{x:Bind ReceiptDateDisplay}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="1" Text="{x:Bind ReceiptCode}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="2" Text="{x:Bind CouponName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="3" Text="{x:Bind CustomerName}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="4" Text="{x:Bind CustomerPhone}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="5" Text="{x:Bind SalesPersonName}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="6" Text="{Binding ExpiresAt, Converter={StaticResource NullableDateToString}}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="7" Text="{x:Bind TotalPriceDisplay}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>

                                            <!-- vertical separators -->
                                            <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="6" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <!-- SummaryByCoupon table -->
                        <Border Grid.Row="0" Background="{ThemeResource SubtleFillColorSecondaryBrush}" BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=SummaryByCoupon}">
                            <Grid MinWidth="1000">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="3*" MinWidth="180"/>
                                    <ColumnDefinition Width="1*" MinWidth="120"/>
                                    <ColumnDefinition Width="1*" MinWidth="120"/>
                                    <ColumnDefinition Width="1*" MinWidth="90"/>
                                    <ColumnDefinition Width="1*" MinWidth="120"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="คูปอง" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="ประเภท" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="จำกัด/ไม่จำกัด" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="3" Text="จำนวนขายรวม" FontWeight="SemiBold" TextAlignment="Center" Padding="5"/>
                                <TextBlock Grid.Column="4" Text="ยอดรวม (บาท)" FontWeight="SemiBold" TextAlignment="Center" Padding="5"/>

                                <!-- vertical separators -->
                                <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                            </Grid>
                        </Border>

                        <ItemsControl Grid.Row="1" ItemsSource="{x:Bind ViewModel.ReportData, Mode=OneWay}" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=SummaryByCoupon}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="local:SalesReportItem">
                                    <Border BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8">
                                        <Grid MinWidth="1000">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="3*" MinWidth="180"/>
                                                <ColumnDefinition Width="1*" MinWidth="120"/>
                                                <ColumnDefinition Width="1*" MinWidth="120"/>
                                                <ColumnDefinition Width="1*" MinWidth="90"/>
                                                <ColumnDefinition Width="1*" MinWidth="120"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" Text="{x:Bind CouponName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="1" Text="{x:Bind CouponTypeName}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="2" Text="{x:Bind IsLimitedDisplay}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="3" Text="{x:Bind Quantity}" VerticalAlignment="Center" TextAlignment="Center" Padding="5"/>
                                            <TextBlock Grid.Column="4" Text="{x:Bind TotalPriceDisplay}" VerticalAlignment="Center" TextAlignment="Center" Padding="5"/>

                                            <!-- vertical separators -->
                                            <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                       <!-- RemainingCoupons table -->
       <Border Grid.Row="0" Background="{ThemeResource SubtleFillColorSecondaryBrush}" BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=RemainingCoupons}">
              <Grid MinWidth="1000">
      <Grid.ColumnDefinitions>
         <ColumnDefinition Width="*" MinWidth="80"/>
 <ColumnDefinition Width="2*" MinWidth="200"/>
    <ColumnDefinition Width="*" MinWidth="120"/>
<ColumnDefinition Width="*" MinWidth="120"/>
   <ColumnDefinition Width="*" MinWidth="120"/>
   <ColumnDefinition Width="*" MinWidth="120"/>
   <ColumnDefinition Width="*" MinWidth="120"/>
     </Grid.ColumnDefinitions>
             <TextBlock Grid.Column="0" Text="รหัส" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
        <TextBlock Grid.Column="1" Text="ชื่อคูปอง" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
   <TextBlock Grid.Column="2" Text="ประเภท" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
    <TextBlock Grid.Column="3" Text="จำนวนรวม" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
   <TextBlock Grid.Column="4" Text="ขายแล้ว" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
               <TextBlock Grid.Column="5" Text="คงเหลือ" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
        <TextBlock Grid.Column="6" Text="ราคา/ใบ" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>

              <!-- vertical separators -->
       <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
    <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
              <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
     <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
     <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
     <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
               </Grid>
          </Border>

                        <!-- CancelledReceipts table (เหมือน ByReceipt แต่เพิ่มคอลัมน์สถานะ) -->
                        <Border Grid.Row="0" Background="{ThemeResource SubtleFillColorSecondaryBrush}" BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=CancelledReceipts}">
                            <Grid MinWidth="1300">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="70"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                    <ColumnDefinition Width="*" MinWidth="80"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="วันที่" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="เลขที่ใบเสร็จ" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="สถานะ" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="3" Text="ลูกค้า" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="4" Text="เบอร์โทร" FontWeight="SemiBold" TextAlignment="Center" Padding="5"/>
                                <TextBlock Grid.Column="5" Text="เซล" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="6" Text="การชำระเงิน" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="7" Text="จำนวน" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                <TextBlock Grid.Column="8" Text="รวม" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>

                                <!-- vertical separators -->
                                <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="6" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                <Rectangle Grid.Column="7" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                            </Grid>
                        </Border>

                        <ItemsControl Grid.Row="1" ItemsSource="{x:Bind ViewModel.ReportData, Mode=OneWay}" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=CancelledReceipts}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="local:SalesReportItem">
                                    <Border BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8">
                                        <Grid MinWidth="1300">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="70"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                                <ColumnDefinition Width="*" MinWidth="80"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="{x:Bind ReceiptDateDisplay}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="1" Text="{x:Bind ReceiptCode}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="2" Text="{x:Bind ReceiptStatusDisplay}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center" Foreground="{x:Bind ReceiptStatusColor}"/>
                                            <TextBlock Grid.Column="3" Text="{x:Bind CustomerName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" TextTrimming="CharacterEllipsis" MaxLines="2" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="4" Text="{x:Bind CustomerPhone}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="5" Text="{x:Bind SalesPersonName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="6" Text="{x:Bind PaymentMethodName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="7" Text="{x:Bind Quantity}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
                                            <TextBlock Grid.Column="8" Text="{x:Bind TotalPriceDisplay}" VerticalAlignment="Center" FontWeight="SemiBold" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>

                                            <!-- vertical separators -->
                                            <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="6" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                            <Rectangle Grid.Column="7" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <ItemsControl Grid.Row="1" ItemsSource="{x:Bind ViewModel.ReportData, Mode=OneWay}" Visibility="{Binding Path=ViewModel.ReportMode, ElementName=RootPage, Converter={StaticResource ReportModeToVisibility}, ConverterParameter=RemainingCoupons}">
         <ItemsControl.ItemTemplate>
          <DataTemplate x:DataType="local:SalesReportItem">
     <Border BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}" BorderThickness="0,0,0,1" Padding="10,8">
     <Grid MinWidth="1000">
   <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" MinWidth="80"/>
     <ColumnDefinition Width="2*" MinWidth="200"/>
<ColumnDefinition Width="*" MinWidth="120"/>
     <ColumnDefinition Width="*" MinWidth="120"/>
       <ColumnDefinition Width="*" MinWidth="120"/>
     <ColumnDefinition Width="*" MinWidth="120"/>
     <ColumnDefinition Width="*" MinWidth="120"/>
            </Grid.ColumnDefinitions>

         <TextBlock Grid.Column="0" Text="{x:Bind CouponCode}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
     <TextBlock Grid.Column="1" Text="{x:Bind CouponName}" VerticalAlignment="Center" TextWrapping="Wrap" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
  <TextBlock Grid.Column="2" Text="{x:Bind CouponTypeName}" VerticalAlignment="Center" Padding="5" HorizontalAlignment="Center" TextAlignment="Center"/>
       <TextBlock Grid.Column="3" Text="{x:Bind TotalQuantity}" VerticalAlignment="Center" TextAlignment="Center" Padding="5"/>
<TextBlock Grid.Column="4" Text="{x:Bind SoldQuantity}" VerticalAlignment="Center" TextAlignment="Center" Padding="5"/>
       <TextBlock Grid.Column="5" Text="{x:Bind RemainingQuantity}" VerticalAlignment="Center" TextAlignment="Center" Padding="5" FontWeight="SemiBold" Foreground="{x:Bind RemainingQuantityColor}"/>
        <TextBlock Grid.Column="6" Text="{x:Bind UnitPriceDisplay}" VerticalAlignment="Center" TextAlignment="Center" Padding="5"/>

  <!-- vertical separators -->
       <Rectangle Grid.Column="0" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
  <Rectangle Grid.Column="1" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
                <Rectangle Grid.Column="2" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
      <Rectangle Grid.Column="3" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
 <Rectangle Grid.Column="4" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
    <Rectangle Grid.Column="5" HorizontalAlignment="Right" Width="1" Fill="#444" VerticalAlignment="Stretch" />
         </Grid>
                </Border>
      </DataTemplate>
              </ItemsControl.ItemTemplate>
              </ItemsControl>
 </Grid>
          </ScrollViewer>
     </Grid>
   </Border>

     <!-- Back Button - Fixed at bottom -->
        <Button Grid.Row="3" Content="กลับหน้าหลัก" 
     Click="BackButton_Click" 
                HorizontalAlignment="Center" 
       Margin="0,20,0,0" 
       MinWidth="150"/>
    </Grid>
</Page>
